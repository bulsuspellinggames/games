<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spelling Bee Challenge - Grade 6</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Comic Sans MS', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M30,30 Q50,10 70,30 T90,30" fill="none" stroke="%23ff9966" stroke-width="2" opacity="0.3"/><path d="M10,50 Q30,30 50,50 T70,50" fill="none" stroke="%23ff9966" stroke-width="2" opacity="0.3"/><circle cx="20" cy="80" r="5" fill="%23ff9966" opacity="0.3"/><circle cx="80" cy="20" r="5" fill="%23ff9966" opacity="0.3"/></svg>');
            background-size: 150px;
        }
        
        .game-container {
            background-color: white;
            border-radius: 25px;
            box-shadow: 0 15px 35px rgba(255, 107, 53, 0.2), 0 5px 15px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 900px;
            padding: 30px;
            position: relative;
            overflow: hidden;
            border: 8px solid #ff9966;
        }
        
        .game-container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: repeating-linear-gradient(90deg, #ff9966, #ff9966 10px, #ffcc00 10px, #ffcc00 20px);
        }
        
        .game-title {
            text-align: center;
            color: #ff6b35;
            margin-bottom: 5px;
            font-size: 3rem;
            position: relative;
            text-shadow: 3px 3px 0 #ffcc00;
            letter-spacing: 1px;
            background: linear-gradient(to right, #ff6b35, #ff9966, #ffcc00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            text-align: center;
            color: #ff9966;
            margin-bottom: 30px;
            font-size: 1.4rem;
            font-weight: bold;
            background-color: #fff5e6;
            padding: 10px;
            border-radius: 15px;
            border: 3px dashed #ffcc00;
            box-shadow: 0 4px 6px rgba(255, 107, 53, 0.1);
        }
        
        .player-info {
            display: flex;
            justify-content: space-between;
            background: linear-gradient(to right, #ff9966, #ffcc00);
            padding: 15px 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 4px solid white;
            box-shadow: 0 6px 0 #ff6b35;
            position: relative;
        }
        
        .player-info::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 20px;
            right: 20px;
            height: 10px;
            background-color: #ff9966;
            border-radius: 0 0 5px 5px;
            opacity: 0.5;
        }
        
        .player-name {
            font-weight: bold;
            color: white;
            font-size: 1.4rem;
            text-shadow: 1px 1px 0 #ff6b35;
        }
        
        .score-display {
            background-color: white;
            color: #ff6b35;
            padding: 10px 25px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.3rem;
            border: 3px solid #ffcc00;
            box-shadow: 0 4px 0 #ff9966;
        }
        
        .level-display {
            background-color: white;
            color: #ff6b35;
            padding: 10px 25px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.3rem;
            border: 3px solid #ff9966;
            box-shadow: 0 4px 0 #ffcc00;
        }
        
        .timer-container {
            height: 25px;
            background-color: #ffe6d5;
            border-radius: 15px;
            margin: 25px 0 15px;
            overflow: hidden;
            border: 3px solid #ff9966;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        .timer-bar {
            height: 100%;
            background: linear-gradient(to right, #4cd964, #ffcc00, #ff6b35);
            width: 100%;
            transition: width 1s linear;
            border-radius: 12px;
        }
        
        .timer-text {
            text-align: center;
            font-weight: bold;
            color: #ff6b35;
            margin-top: 5px;
            font-size: 1.3rem;
            background-color: #fff5e6;
            display: inline-block;
            padding: 8px 20px;
            border-radius: 50px;
            border: 3px solid #ffcc00;
        }
        
        .question-container {
            background-color: #fff9f0;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 25px;
            text-align: center;
            border: 5px solid #ffcc00;
            box-shadow: 0 8px 0 #ff9966;
            position: relative;
        }
        
        .question-container::before {
            content: "‚úèÔ∏è";
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2rem;
            background-color: white;
            padding: 5px 15px;
            border-radius: 50px;
            border: 3px solid #ff9966;
        }
        
        .instruction {
            color: #ff6b35;
            font-size: 1.6rem;
            margin-bottom: 30px;
            font-weight: bold;
            text-shadow: 1px 1px 0 #ffcc00;
        }
        
        .word-display {
            font-size: 2.5rem;
            font-weight: bold;
            color: #ff6b35;
            margin: 10px 0 30px;
            min-height: 50px;
            padding: 15px;
            background-color: white;
            border-radius: 15px;
            border: 4px dashed #ff9966;
            box-shadow: inset 0 0 10px rgba(255, 107, 53, 0.1);
            letter-spacing: 2px;
        }
        
        .options-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }
        
        @media (max-width: 600px) {
            .options-container {
                grid-template-columns: 1fr;
            }
        }
        
        .option {
            background-color: white;
            border: 4px solid #ffcc00;
            border-radius: 15px;
            padding: 20px 15px;
            font-size: 1.4rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            font-weight: bold;
            color: #ff6b35;
            box-shadow: 0 6px 0 #ff9966;
            position: relative;
        }
        
        .option:hover {
            background-color: #fff5e6;
            transform: translateY(-5px);
            box-shadow: 0 10px 0 #ff9966;
        }
        
        .option:active {
            transform: translateY(-2px);
            box-shadow: 0 8px 0 #ff9966;
        }
        
        .option.selected {
            border-color: #4cd964;
            background-color: #e8f7ee;
            box-shadow: 0 6px 0 #2ecc71;
        }
        
        .option::before {
            content: attr(data-letter);
            position: absolute;
            top: -15px;
            left: 20px;
            background-color: #ff9966;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 1.2rem;
            border: 3px solid white;
            box-shadow: 0 3px 0 #ff6b35;
        }
        
        .feedback-container {
            min-height: 100px;
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 25px;
            text-align: center;
            font-size: 1.6rem;
            font-weight: bold;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 8px 0 rgba(0, 0, 0, 0.1);
            border-width: 4px;
            border-style: solid;
            position: relative;
            overflow: hidden;
        }
        
        .feedback-container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: repeating-linear-gradient(90deg, transparent, transparent 10px, rgba(255, 255, 255, 0.5) 10px, rgba(255, 255, 255, 0.5) 20px);
        }
        
        .correct-feedback {
            background-color: rgba(76, 217, 100, 0.15);
            color: #2e8b57;
            border-color: #4cd964;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><text x="50" y="70" font-size="80" text-anchor="middle" fill="%234cd964" opacity="0.2">‚úì</text></svg>');
        }
        
        .wrong-feedback {
            background-color: rgba(255, 107, 53, 0.15);
            color: #cc3300;
            border-color: #ff6b35;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><text x="50" y="70" font-size="80" text-anchor="middle" fill="%23ff6b35" opacity="0.2">‚úó</text></svg>');
        }
        
        .correct-answer {
            margin-top: 15px;
            font-size: 1.4rem;
            color: #ff6b35;
            font-weight: normal;
            background-color: white;
            padding: 10px 20px;
            border-radius: 10px;
            border: 2px dashed #ff9966;
        }
        
        .buttons-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .btn {
            padding: 18px 35px;
            border: none;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 0 rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .btn::after {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.7s;
        }
        
        .btn:hover::after {
            left: 100%;
        }
        
        .btn-start {
            background: linear-gradient(to bottom, #4cd964, #2ecc71);
            color: white;
            text-shadow: 1px 1px 0 #27ae60;
            border-bottom: 6px solid #27ae60;
        }
        
        .btn-next {
            background: linear-gradient(to bottom, #ffcc00, #ff9966);
            color: white;
            text-shadow: 1px 1px 0 #ff6b35;
            border-bottom: 6px solid #ff6b35;
        }
        
        .btn-restart {
            background: linear-gradient(to bottom, #ff6b35, #ff4757);
            color: white;
            text-shadow: 1px 1px 0 #cc3300;
            border-bottom: 6px solid #cc3300;
        }
        
        .btn-home {
            background: linear-gradient(to bottom, #9b59b6, #8e44ad);
            color: white;
            text-shadow: 1px 1px 0 #6c3483;
            border-bottom: 6px solid #6c3483;
        }
        
        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 0 rgba(0, 0, 0, 0.2);
        }
        
        .btn:active {
            transform: translateY(-2px);
            box-shadow: 0 10px 0 rgba(0, 0, 0, 0.2);
        }
        
        .btn:disabled {
            background: linear-gradient(to bottom, #bdc3c7, #95a5a6);
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 8px 0 rgba(0, 0, 0, 0.2);
            border-bottom: 6px solid #7f8c8d;
        }
        
        .btn:disabled:hover::after {
            left: -100%;
        }
        
        .game-over-container {
            text-align: center;
            padding: 30px;
            background-color: #fff9f0;
            border-radius: 20px;
            border: 5px solid #ffcc00;
            box-shadow: 0 10px 0 #ff9966;
            position: relative;
        }
        
        .game-over-container::before {
            content: "üèÜ";
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 4rem;
            background-color: white;
            padding: 10px;
            border-radius: 50%;
            border: 5px solid #ffcc00;
            box-shadow: 0 5px 0 #ff9966;
            z-index: 1;
        }
        
        .final-score {
            font-size: 4rem;
            color: #ff6b35;
            margin: 40px 0 20px;
            text-shadow: 3px 3px 0 #ffcc00;
            background-color: white;
            padding: 20px;
            border-radius: 20px;
            border: 5px dashed #ff9966;
            display: inline-block;
        }
        
        .congratulations {
            color: #ff6b35;
            font-size: 2.5rem;
            margin: 20px 0;
            animation: pulse 1.5s infinite;
            text-shadow: 2px 2px 0 #ffcc00;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .setup-screen {
            text-align: center;
            padding: 30px;
            background-color: #fff9f0;
            border-radius: 20px;
            border: 5px solid #ffcc00;
            box-shadow: 0 10px 0 #ff9966;
        }
        
        .setup-screen p {
            font-size: 1.4rem;
            color: #ff6b35;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .level-indicator {
            display: flex;
            justify-content: center;
            margin: 20px 0 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .level-dot {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #ffe6d5;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: #ff9966;
            font-size: 1.3rem;
            border: 4px solid #ffcc00;
            box-shadow: 0 5px 0 #ff9966;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .level-dot.active {
            background-color: #ffcc00;
            color: white;
            border-color: #ff9966;
            transform: scale(1.1);
            box-shadow: 0 5px 0 #ff6b35, 0 0 20px rgba(255, 204, 0, 0.7);
        }
        
        .level-dot.completed {
            background-color: #4cd964;
            color: white;
            border-color: #2ecc71;
        }
        
        .level-dot::after {
            content: "";
            position: absolute;
            top: 50%;
            left: calc(100% + 5px);
            width: 15px;
            height: 5px;
            background-color: #ffcc00;
            display: none;
        }
        
        .level-dot:not(:last-child)::after {
            display: block;
        }
        
        .hidden {
            display: none;
        }
        
        .urgent-timer {
            color: #ff6b35;
            animation: blink 1s infinite;
            font-weight: bold;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .home-button-container {
            margin-top: 30px;
            text-align: center;
        }
        
        .bee-icon {
            position: absolute;
            font-size: 2rem;
            z-index: 1;
            animation: float 3s infinite ease-in-out;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .honeycomb-bg {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            opacity: 0.05;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M50,0 L75,25 L75,75 L50,100 L25,75 L25,25 Z" fill="%23ff9966"/></svg>');
            background-size: 80px;
        }
        
        .confetti {
            position: absolute;
            width: 15px;
            height: 15px;
            background-color: #ffcc00;
            opacity: 0.7;
            border-radius: 2px;
        }
        
        @media (max-width: 768px) {
            .game-title {
                font-size: 2.2rem;
            }
            
            .player-info {
                flex-direction: column;
                gap: 15px;
                align-items: center;
            }
            
            .options-container {
                gap: 15px;
            }
            
            .option {
                font-size: 1.2rem;
                padding: 15px 10px;
            }
            
            .btn {
                padding: 15px 25px;
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Decorative bees -->
    <div class="bee-icon" style="top: 5%; left: 5%;">üêù</div>
    <div class="bee-icon" style="top: 10%; right: 10%;">üêù</div>
    <div class="bee-icon" style="bottom: 15%; left: 15%;">üêù</div>
    
    <!-- Honeycomb background pattern -->
    <div class="honeycomb-bg"></div>
    
    <div class="game-container">
        <h1 class="game-title">Spelling Bee Challenge</h1>
        <div class="subtitle">Grade 6 Level Spelling Quiz - 10 Seconds Per Level!</div>
        
        <!-- Setup Screen -->
        <div id="setupScreen" class="setup-screen">
            <p>üêù Welcome to the Spelling Bee Challenge! üêù</p>
            <p>Test your spelling skills with 10 levels of increasingly difficult words!</p>
            <p>Each correct answer gives you <strong>10 points</strong>. You have <strong>10 seconds</strong> per level.</p>
            <p>Can you become the Spelling Bee Champion? üèÜ</p>
            
            <div class="buttons-container">
                <button id="startGame" class="btn btn-start">Start Game üêù</button>
            </div>
            
            <div class="home-button-container">
                <button id="homeButtonBefore" class="btn btn-home">Back to Home</button>
            </div>
        </div>
        
        <!-- Game Screen -->
        <div id="gameScreen" class="hidden">
            <div class="player-info">
                <div class="player-name">Player: <span id="currentPlayerName">Player</span></div>
                <div class="score-display">Score: <span id="currentScore">0</span></div>
                <div class="level-display">Level: <span id="currentLevel">1</span>/10</div>
            </div>
            
            <div class="level-indicator" id="levelIndicator">
                <!-- Level dots will be added by JavaScript -->
            </div>
            
            <div class="timer-container">
                <div id="timerBar" class="timer-bar"></div>
            </div>
            <div class="timer-text">Time remaining: <span id="timeLeft">10</span> seconds</div>
            
            <div class="question-container">
                <div class="instruction">Select the correct spelling:</div>
                <div class="word-display" id="wordDisplay"></div>
                
                <div class="options-container" id="optionsContainer">
                    <!-- Options will be added by JavaScript -->
                </div>
            </div>
            
            <div id="feedbackContainer" class="feedback-container hidden">
                <!-- Feedback will be added by JavaScript -->
            </div>
            
            <div class="buttons-container">
                <button id="nextBtn" class="btn btn-next hidden">Next Level üêù</button>
                <button id="homeButtonDuring" class="btn btn-home">Back to Home</button>
            </div>
        </div>
        
        <!-- Game Over Screen -->
        <div id="gameOverScreen" class="game-over-container hidden">
            <!-- Game Over heading removed as requested -->
            <div class="final-score">
                <span id="finalScoreMessage">Your Score: <span id="finalScore">0</span></span>
            </div>
            <p>Thanks for playing, <span id="endPlayerName">Player</span>!</p>
            <p>üêù Keep buzzing with your spelling skills! üêù</p>
            
            <div class="buttons-container">
                <button id="restartGame" class="btn btn-restart">Play Again üêù</button>
                <button id="homeButtonAfter" class="btn btn-home">Back to Home</button>
            </div>
        </div>
    </div>

    <script>
        // Game data - Grade 6 spelling words with increasing difficulty
        const spellingData = [
            // Level 1
            {
                word: "accommodate",
                options: ["acomodate", "accommodate", "acommodate", "accomodate"],
                correctIndex: 1
            },
            // Level 2
            {
                word: "appreciate",
                options: ["apreciate", "appreciate", "appriciate", "aprecciate"],
                correctIndex: 1
            },
            // Level 3
            {
                word: "committee",
                options: ["comittee", "committee", "commitee", "comitee"],
                correctIndex: 1
            },
            // Level 4
            {
                word: "embarrass",
                options: ["embarass", "embarras", "embarrass", "embarass"],
                correctIndex: 2
            },
            // Level 5
            {
                word: "exaggerate",
                options: ["exagerate", "exaggerate", "exaggarate", "exagerrate"],
                correctIndex: 1
            },
            // Level 6
            {
                word: "harassment",
                options: ["harasment", "harrassment", "harassment", "harassmant"],
                correctIndex: 2
            },
            // Level 7
            {
                word: "immediately",
                options: ["imediately", "immediately", "immediatly", "imediatly"],
                correctIndex: 1
            },
            // Level 8
            {
                word: "millennium",
                options: ["milennium", "millenium", "millennium", "milenium"],
                correctIndex: 2
            },
            // Level 9
            {
                word: "occurrence",
                options: ["occurance", "occurrence", "ocurrence", "ocurrance"],
                correctIndex: 1
            },
            // Level 10
            {
                word: "perseverance",
                options: ["perseverence", "perseverance", "preserverance", "perseverence"],
                correctIndex: 1
            }
        ];

        // Game state variables
        let currentLevel = 0;
        let score = 0;
        let playerName = "Player";
        let timer;
        let timeLeft = 10; // Changed from 20 to 10 seconds
        let gameActive = false;
        let selectedOption = null;
        let answerSubmitted = false;

        // DOM elements
        const setupScreen = document.getElementById('setupScreen');
        const gameScreen = document.getElementById('gameScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');
        const startGameBtn = document.getElementById('startGame');
        const currentPlayerNameSpan = document.getElementById('currentPlayerName');
        const currentScoreSpan = document.getElementById('currentScore');
        const currentLevelSpan = document.getElementById('currentLevel');
        const wordDisplay = document.getElementById('wordDisplay');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackContainer = document.getElementById('feedbackContainer');
        const nextBtn = document.getElementById('nextBtn');
        const timerBar = document.getElementById('timerBar');
        const timeLeftSpan = document.getElementById('timeLeft');
        const finalScoreSpan = document.getElementById('finalScore');
        const endPlayerNameSpan = document.getElementById('endPlayerName');
        const restartGameBtn = document.getElementById('restartGame');
        const levelIndicator = document.getElementById('levelIndicator');
        const homeButtonBefore = document.getElementById('homeButtonBefore');
        const homeButtonDuring = document.getElementById('homeButtonDuring');
        const homeButtonAfter = document.getElementById('homeButtonAfter');

        // Function to navigate back to homepage
        function goToHomepage() {
            // Clear any active timers
            clearInterval(timer);
            
            // Navigate to homepage
            window.location.href = "index.html";
        }

        // Get player name from URL parameters
        function getPlayerNameFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const playerNameFromURL = urlParams.get('player');
            return playerNameFromURL || "Spelling Champion";
        }

        // Initialize level indicators
        function initializeLevelIndicators() {
            levelIndicator.innerHTML = '';
            for (let i = 1; i <= 10; i++) {
                const levelDot = document.createElement('div');
                levelDot.className = 'level-dot';
                levelDot.textContent = i;
                levelDot.id = `levelDot${i}`;
                levelIndicator.appendChild(levelDot);
            }
        }

        // Update level indicators
        function updateLevelIndicators() {
            for (let i = 1; i <= 10; i++) {
                const levelDot = document.getElementById(`levelDot${i}`);
                if (i === currentLevel + 1) {
                    levelDot.className = 'level-dot active';
                } else if (i < currentLevel + 1) {
                    levelDot.className = 'level-dot completed';
                } else {
                    levelDot.className = 'level-dot';
                }
            }
        }

        // Start the game
        startGameBtn.addEventListener('click', () => {
            // Get player name from URL parameters
            playerName = getPlayerNameFromURL();
            currentPlayerNameSpan.textContent = playerName;
            
            setupScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            
            initializeLevelIndicators();
            startLevel();
        });

        // Start a new level
        function startLevel() {
            currentLevelSpan.textContent = currentLevel + 1;
            currentScoreSpan.textContent = score;
            answerSubmitted = false;
            selectedOption = null;
            
            // Reset UI
            feedbackContainer.classList.add('hidden');
            nextBtn.classList.add('hidden');
            optionsContainer.innerHTML = '';
            timeLeftSpan.className = ''; // Reset timer color
            
            // Update level indicators
            updateLevelIndicators();
            
            // Get the current word data
            const wordData = spellingData[currentLevel];
            
            // Clear the word display area
            wordDisplay.textContent = "";
            
            // Create option buttons
            const options = ['A', 'B', 'C', 'D'];
            wordData.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.dataset.index = index;
                optionElement.setAttribute('data-letter', options[index]);
                
                optionElement.addEventListener('click', () => {
                    if (!answerSubmitted) {
                        // Deselect previously selected option
                        if (selectedOption !== null) {
                            document.querySelectorAll('.option').forEach(opt => {
                                opt.classList.remove('selected');
                            });
                        }
                        
                        // Select this option
                        optionElement.classList.add('selected');
                        selectedOption = index;
                        
                        // Check answer
                        checkAnswer(index, wordData.correctIndex);
                    }
                });
                
                optionsContainer.appendChild(optionElement);
            });
            
            // Start the timer
            startTimer();
        }

        // Start the countdown timer (10 seconds)
        function startTimer() {
            timeLeft = 10; // 10 seconds timer
            timeLeftSpan.textContent = timeLeft;
            timerBar.style.width = '100%';
            gameActive = true;
            
            clearInterval(timer);
            timer = setInterval(() => {
                timeLeft--;
                timeLeftSpan.textContent = timeLeft;
                
                // Update timer bar width
                timerBar.style.width = `${(timeLeft / 10) * 100}%`;
                
                // Make timer text red when 5 seconds or less remain
                if (timeLeft <= 5) {
                    timeLeftSpan.className = 'urgent-timer';
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    timeOut();
                }
            }, 1000);
        }

        // Handle time running out
        function timeOut() {
            gameActive = false;
            answerSubmitted = true;
            
            const wordData = spellingData[currentLevel];
            
            // Show wrong answer feedback
            feedbackContainer.innerHTML = `
                <div>Time's up! ‚è∞</div>
                <div class="correct-answer">Correct spelling: ${wordData.options[wordData.correctIndex]}</div>
            `;
            feedbackContainer.className = 'feedback-container wrong-feedback';
            feedbackContainer.classList.remove('hidden');
            
            // Show next button
            nextBtn.classList.remove('hidden');
        }

        // Check if the selected answer is correct
        function checkAnswer(selectedIndex, correctIndex) {
            gameActive = false;
            answerSubmitted = true;
            clearInterval(timer);
            
            const wordData = spellingData[currentLevel];
            
            if (selectedIndex === correctIndex) {
                // Correct answer
                score += 10;
                currentScoreSpan.textContent = score;
                
                feedbackContainer.innerHTML = `<div>Correct! üéâ</div>`;
                feedbackContainer.className = 'feedback-container correct-feedback';
                feedbackContainer.classList.remove('hidden');
            } else {
                // Wrong answer
                feedbackContainer.innerHTML = `
                    <div>Wrong üòû</div>
                    <div class="correct-answer">Correct spelling: ${wordData.options[correctIndex]}</div>
                `;
                feedbackContainer.className = 'feedback-container wrong-feedback';
                feedbackContainer.classList.remove('hidden');
            }
            
            // Show next button
            nextBtn.classList.remove('hidden');
        }

        // Move to the next level
        nextBtn.addEventListener('click', () => {
            currentLevel++;
            
            if (currentLevel < 10) {
                startLevel();
            } else {
                endGame();
            }
        });

        // End the game and show results
        function endGame() {
            gameScreen.classList.add('hidden');
            gameOverScreen.classList.remove('hidden');
            
            finalScoreSpan.textContent = score;
            endPlayerNameSpan.textContent = playerName;
            
            // Check for perfect score and update message accordingly
            const finalScoreMessage = document.getElementById('finalScoreMessage');
            if (score === 100) {
                finalScoreMessage.innerHTML = `üèÜ Perfect Score! <span id="finalScore">100</span> üèÜ`;
            } else {
                finalScoreMessage.innerHTML = `Your Score: <span id="finalScore">${score}</span>`;
            }
            
            // Save the final score to localStorage
            saveScoreToDashboard();
            
            // Create confetti effect for good scores
            if (score >= 70) {
                createConfetti();
            }
        }

        // Create confetti effect
        function createConfetti() {
            const container = document.querySelector('.game-over-container');
            const colors = ['#ffcc00', '#ff9966', '#ff6b35', '#4cd964', '#9b59b6'];
            
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.top = Math.random() * 100 + '%';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                confetti.style.width = Math.random() * 10 + 10 + 'px';
                confetti.style.height = Math.random() * 10 + 10 + 'px';
                confetti.style.opacity = Math.random() * 0.5 + 0.3;
                confetti.style.animation = `float ${Math.random() * 3 + 2}s infinite ease-in-out`;
                confetti.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(confetti);
                
                // Remove confetti after animation
                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }

        // Function to save score to dashboard
        function saveScoreToDashboard() {
            // Get existing scores from localStorage
            let allScores = JSON.parse(localStorage.getItem('gameScores') || '[]');
            
            // Remove any existing entry for this player (to ensure only one record per player)
            allScores = allScores.filter(score => score.playerName !== playerName);
            
            // Create the new score entry
            const newScore = {
                playerName: playerName,
                score: score,
                gameType: "Spelling Bee Challenge",
                timestamp: new Date().toISOString()
            };
            
            // Add the new score to the array
            allScores.push(newScore);
            
            // Sort by timestamp (newest first) and keep only latest 40 scores
allScores.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

// If more than 40 scores, remove the oldest ones
if (allScores.length > 40) {
    allScores = allScores.slice(0, 40);
}
            // Save back to localStorage
            localStorage.setItem('gameScores', JSON.stringify(allScores));
        }

        // Restart the game
        restartGameBtn.addEventListener('click', () => {
            currentLevel = 0;
            score = 0;
            gameActive = false;
            answerSubmitted = false;
            selectedOption = null;
            
            gameOverScreen.classList.add('hidden');
            setupScreen.classList.remove('hidden');
            
            // Reset player name in case it needs to be fetched again
            playerName = getPlayerNameFromURL();
            currentPlayerNameSpan.textContent = playerName;
        });

        // Add event listeners for home buttons
        homeButtonBefore.addEventListener('click', goToHomepage);
        homeButtonDuring.addEventListener('click', goToHomepage);
        homeButtonAfter.addEventListener('click', goToHomepage);

        // Initialize the game
        initializeLevelIndicators();
        
        // Set player name from URL on page load
        window.addEventListener('DOMContentLoaded', () => {
            playerName = getPlayerNameFromURL();
            currentPlayerNameSpan.textContent = playerName;
            endPlayerNameSpan.textContent = playerName;
        });
    </script>
</body>
</html>